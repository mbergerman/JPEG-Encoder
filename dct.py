import numpy as np
from scipy import fft

C_N = np.matrix([
     [ 0.35355339,  0.35355339,  0.35355339 , 0.35355339,  0.35355339,  0.35355339,0.35355339,  0.35355339],
     [ 0.49039264,  0.41573481,  0.27778512,  0.09754516, -0.09754516, -0.27778512,-0.41573481, -0.49039264],
     [ 0.46193977,  0.19134172, -0.19134172, -0.46193977, -0.46193977, -0.19134172,0.19134172,  0.46193977],
     [ 0.41573481, -0.09754516, -0.49039264, -0.27778512,  0.27778512,  0.49039264, 0.09754516, -0.41573481],
     [ 0.35355339, -0.35355339, -0.35355339,  0.35355339,  0.35355339, -0.35355339,-0.35355339,  0.35355339],
     [ 0.27778512, -0.49039264,  0.09754516,  0.41573481, -0.41573481, -0.09754516, 0.49039264, -0.27778512],
     [ 0.19134172, -0.46193977,  0.46193977, -0.19134172, -0.19134172,  0.46193977, -0.46193977,  0.19134172],
     [ 0.09754516, -0.27778512,  0.41573481, -0.49039264,  0.49039264, -0.41573481, 0.27778512, -0.09754516]
    ])
C_N_T = np.matrix([
    [ 0.35355339,  0.49039264,  0.46193977,  0.41573481,  0.35355339,  0.27778512, 0.19134172,  0.09754516],
    [ 0.35355339,  0.41573481,  0.19134172, -0.09754516, -0.35355339, -0.49039264, -0.46193977, -0.27778512],
    [ 0.35355339,  0.27778512, -0.19134172, -0.49039264, -0.35355339,  0.09754516, 0.46193977, 0.41573481],
    [ 0.35355339,  0.09754516, -0.46193977, -0.27778512,  0.35355339, 0.41573481, -0.19134172, -0.49039264],
    [ 0.35355339, -0.09754516, -0.46193977,  0.27778512,  0.35355339, -0.41573481, -0.19134172,  0.49039264],
    [ 0.35355339, -0.27778512, -0.19134172,  0.49039264, -0.35355339, -0.09754516,0.46193977, -0.41573481],
    [ 0.35355339, -0.41573481,  0.19134172, 0.09754516, -0.35355339, 0.49039264, -0.46193977, 0.27778512],
    [ 0.35355339, -0.49039264, 0.46193977, -0.41573481,  0.35355339, -0.27778512, 0.19134172, -0.09754516]
    ])

def dct(x):
    return np.matmul(np.matmul(C_N,x),C_N_T)

    
def idct(X):
    x = fft.idct(fft.idct(X.T, norm='ortho').T, norm='ortho')
    return x